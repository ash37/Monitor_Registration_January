name: Monitor Registration (debug)

on:
  workflow_dispatch: {}

jobs:
  check:
    runs-on: ubuntu-latest
    steps:
      - name: Probe without following redirects
        run: |
          set -euo pipefail
          URL="https://registration.rundisney.com/?event=a3069dc761c8d71ead58"

          code=$(curl -sS -o /dev/null -D headers.txt -w "%{http_code}" \
            -A "Mozilla/5.0 (GitHubActions Monitor_Registration_January)" \
            "$URL")

          echo "HTTP: $code"
          echo "---- headers ----"
          sed -n '1,80p' headers.txt

          # Print redirect location if present
          loc=$(grep -i '^location:' headers.txt | head -n 1 | sed 's/\r$//')
          echo "Location: ${loc:-<none>}"
